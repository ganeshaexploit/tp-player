-- âœ¨ Teleport by Ganesha Exploit (Draggable Floating Icon Version) âœ¨
-- âœ… Floating icon show/hide (draggable)
-- âœ… Auto update player list
-- âœ… Random Player teleport
-- âœ… Stable, drag-able main UI

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local ContextActionService = game:GetService("ContextActionService")
local StarterGui = game:GetService("StarterGui")

local localPlayer = Players.LocalPlayer
local playerGui = localPlayer:WaitForChild("PlayerGui")

-- UI Config
local UI_WIDTH, UI_HEIGHT = 320, 440
local TELEPORT_COOLDOWN = 1
local TOGGLE_KEY = Enum.KeyCode.T
local REFRESH_INTERVAL = 5 -- detik

-- Main ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TeleportByGaneshaExploit"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Floating icon
local floatIcon = Instance.new("TextButton")
floatIcon.Size = UDim2.new(0, 50, 0, 50)
floatIcon.Position = UDim2.new(1, -60, 1, -60)
floatIcon.BackgroundColor3 = Color3.fromRGB(200,80,80)
floatIcon.Text = "TP"
floatIcon.Font = Enum.Font.GothamBold
floatIcon.TextSize = 18
floatIcon.TextColor3 = Color3.new(1,1,1)
floatIcon.ZIndex = 10
Instance.new("UICorner", floatIcon).CornerRadius = UDim.new(0, 12)
floatIcon.Parent = screenGui

-- Main frame
local main = Instance.new("Frame")
main.Size = UDim2.new(0, UI_WIDTH, 0, UI_HEIGHT)
main.Position = UDim2.new(0, 20, 0, 80)
main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
main.Visible = false
main.Parent = screenGui
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 12)
Instance.new("UIStroke", main).Color = Color3.fromRGB(50, 50, 55)

-- Title bar
local titleBar = Instance.new("Frame", main)
titleBar.Size = UDim2.new(1, 0, 0, 44)
titleBar.BackgroundTransparency = 1

local title = Instance.new("TextLabel", titleBar)
title.Size = UDim2.new(1, -20, 1, 0)
title.Position = UDim2.new(0, 10, 0, 0)
title.Text = "âœ¨ Teleport by Ganesha Exploit"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.TextXAlignment = Enum.TextXAlignment.Left
title.BackgroundTransparency = 1

-- Random Player button
local randomBtn = Instance.new("TextButton", main)
randomBtn.Size = UDim2.new(1, -20, 0, 32)
randomBtn.Position = UDim2.new(0, 10, 0, 60)
randomBtn.Text = "ðŸŽ² Random Player"
randomBtn.Font = Enum.Font.GothamBold
randomBtn.TextSize = 14
randomBtn.TextColor3 = Color3.new(1,1,1)
randomBtn.BackgroundColor3 = Color3.fromRGB(70,130,180)
Instance.new("UICorner", randomBtn).CornerRadius = UDim.new(0,8)

-- Scroll container
local scroll = Instance.new("ScrollingFrame", main)
scroll.Size = UDim2.new(1, -20, 1, -110)
scroll.Position = UDim2.new(0, 10, 0, 100)
scroll.BackgroundTransparency = 1
scroll.CanvasSize = UDim2.new(0,0,0,0)
scroll.ScrollBarThickness = 6

local layout = Instance.new("UIListLayout", scroll)
layout.Padding = UDim.new(0, 6)
layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	scroll.CanvasSize = UDim2.new(0,0,0, layout.AbsoluteContentSize.Y + 10)
end)

-- Teleport
local lastTeleport = 0
local function teleportToTarget(target, playerName)
	if tick() - lastTeleport < TELEPORT_COOLDOWN then return end
	lastTeleport = tick()
	pcall(function()
		if localPlayer.Character and localPlayer.Character:FindFirstChild("HumanoidRootPart") then
			localPlayer.Character.HumanoidRootPart.CFrame = target.CFrame + Vector3.new(2,0,2)
			StarterGui:SetCore("SendNotification", {
				Title = "âœ¨ Teleport by Ganesha Exploit",
				Text = "Teleported to " .. playerName .. " âœ…",
				Duration = 3
			})
		end
	end)
end

-- Buat tombol player
local function createButton(plr)
	local btn = Instance.new("TextButton", scroll)
	btn.Name = "Btn_"..plr.UserId
	btn.Size = UDim2.new(1, -4, 0, 40)
	btn.Text = "Teleport â†’ " .. plr.Name
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 14
	btn.TextColor3 = Color3.new(1,1,1)
	btn.BackgroundColor3 = Color3.fromRGB(70,130,180)
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0,10)

	btn.MouseButton1Click:Connect(function()
		if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
			teleportToTarget(plr.Character.HumanoidRootPart, plr.Name)
		end
	end)
end

-- Refresh list
local function refreshList()
	for _, child in ipairs(scroll:GetChildren()) do
		if child:IsA("TextButton") then
			child:Destroy()
		end
	end
	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= localPlayer then
			createButton(plr)
		end
	end
end

refreshList()
Players.PlayerAdded:Connect(refreshList)
Players.PlayerRemoving:Connect(refreshList)

-- Random teleport
randomBtn.MouseButton1Click:Connect(function()
	local candidates = {}
	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= localPlayer then
			table.insert(candidates, plr)
		end
	end
	if #candidates > 0 then
		local target = candidates[math.random(1, #candidates)]
		if target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
			teleportToTarget(target.Character.HumanoidRootPart, target.Name)
		end
	end
end)

-- Toggle main UI
local uiVisible = false
floatIcon.MouseButton1Click:Connect(function()
	uiVisible = not uiVisible
	main.Visible = uiVisible
end)
ContextActionService:BindAction("ToggleTeleportUI", function(_, state)
	if state == Enum.UserInputState.Begin then
		uiVisible = not uiVisible
		main.Visible = uiVisible
	end
end, false, TOGGLE_KEY)

-- Drag main frame
local draggingMain, dragStartMain, startPosMain
titleBar.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		draggingMain = true
		dragStartMain = input.Position
		startPosMain = main.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then draggingMain = false end
		end)
	end
end)
UserInputService.InputChanged:Connect(function(input)
	if draggingMain and input.UserInputType == Enum.UserInputType.MouseMovement then
		local delta = input.Position - dragStartMain
		main.Position = UDim2.new(startPosMain.X.Scale, startPosMain.X.Offset + delta.X, startPosMain.Y.Scale, startPosMain.Y.Offset + delta.Y)
	end
end)

-- Drag floating icon
local draggingIcon, dragStartIcon, startPosIcon
floatIcon.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		draggingIcon = true
		dragStartIcon = input.Position
		startPosIcon = floatIcon.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then draggingIcon = false end
		end)
	end
end)
UserInputService.InputChanged:Connect(function(input)
	if draggingIcon and input.UserInputType == Enum.UserInputType.MouseMovement then
		local delta = input.Position - dragStartIcon
		floatIcon.Position = UDim2.new(startPosIcon.X.Scale, startPosIcon.X.Offset + delta.X, startPosIcon.Y.Scale, startPosIcon.Y.Offset + delta.Y)
	end
end)

-- ðŸ”„ Auto Refresh Loop
task.spawn(function()
	while task.wait(REFRESH_INTERVAL) do
		refreshList()
	end
end)
